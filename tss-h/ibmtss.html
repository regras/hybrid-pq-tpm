<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=iso-8859-1"/>
	<title>IBM TSS</title>
	<meta name="generator" content="LibreOffice 4.3.7.2 (Linux)"/>
	<meta name="author" content="Ken Goldman"/>
	<meta name="created" content="2015-11-20T12:35:00"/>
	<meta name="changedby" content="Ken Goldman"/>
	<meta name="changed" content="2018-09-05T14:48:00"/>
	<style type="text/css">
		@page { size: 8.5in 11in; margin-right: 1.25in; margin-top: 1in; margin-bottom: 0.5in }
		p { margin-bottom: 0.08in; direction: ltr; color: #000000; widows: 2; orphans: 2 }
		p.western { font-family: "Times New Roman", serif; font-size: 12pt; so-language: en-US }
		p.cjk { font-family: "Times New Roman", serif; font-size: 12pt }
		p.ctl { font-family: "Times New Roman", serif; font-size: 12pt; so-language: ar-SA }
		h1 { margin-bottom: 0.04in; direction: ltr; color: #000000; widows: 2; orphans: 2 }
		h1.western { font-family: "Arial", sans-serif; font-size: 16pt; so-language: en-US }
		h1.cjk { font-family: "Times New Roman", serif; font-size: 16pt }
		h1.ctl { font-family: "Arial", sans-serif; font-size: 16pt; so-language: ar-SA }
		h2 { margin-top: 0.17in; margin-bottom: 0.04in; direction: ltr; color: #000000; widows: 2; orphans: 2 }
		h2.western { font-family: "Arial", sans-serif; font-size: 14pt; so-language: en-US }
		h2.cjk { font-family: "Times New Roman", serif; font-size: 14pt }
		h2.ctl { font-family: "Arial", sans-serif; font-size: 14pt; so-language: ar-SA; font-style: italic }
		h3 { margin-top: 0.17in; margin-bottom: 0.04in; direction: ltr; color: #000000; widows: 2; orphans: 2 }
		h3.western { font-family: "Cambria", serif; font-size: 13pt; so-language: en-US }
		h3.cjk { font-family: "Times New Roman", serif; font-size: 13pt }
		h3.ctl { font-family: "Cambria", serif; font-size: 13pt; so-language: ar-SA }
		h4 { margin-top: 0.17in; margin-bottom: 0.04in; direction: ltr; color: #000000; widows: 2; orphans: 2 }
		h4.western { font-family: "Calibri", sans-serif; font-size: 14pt; so-language: en-US }
		h4.cjk { font-family: "Times New Roman", serif; font-size: 14pt }
		h4.ctl { font-family: "Times New Roman", serif; font-size: 14pt; so-language: ar-SA }
		a:link { color: #0000ff }
		a.western:link { so-language: en-US }
		a.cjk:link { so-language: en-US }
		a:visited { color: #800080 }
		a.western:visited { so-language: en-US }
		a.cjk:visited { so-language: zh-CN }
		a.ctl:visited { so-language: hi-IN }
	</style>
</head>
<body lang="en-US" text="#000000" link="#0000ff" vlink="#800080" bgcolor="#ffffff" dir="ltr" style="background: #ffffff">
<p lang="da-DK" align="center" style="margin-left: 0.17in; margin-bottom: 0in">
<br/>

</p>
<p align="center" style="margin-top: 0.14in; margin-bottom: 0.33in"><font face="Arial, sans-serif"><font size="6" style="font-size: 24pt">IBM
TPM 2.0 (and 1.2) TSS API</font></font></p>
<p align="center" style="margin-top: 0.14in; margin-bottom: 0.33in"><font face="Arial, sans-serif"><font size="6" style="font-size: 24pt">Ken
Goldman</font></font></p>
<p align="center" style="margin-top: 0.14in; margin-bottom: 0.33in"><font face="Arial, sans-serif"><font size="6" style="font-size: 24pt">IBM
Research</font></font></p>
<p align="center" style="margin-top: 0.14in; margin-bottom: 0.33in"><font face="Arial, sans-serif"><font size="6" style="font-size: 24pt">kgoldman@us.ibm.com</font></font></p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" align="center" style="margin-bottom: 0in"><font size="5" style="font-size: 20pt">July
30September 5, 2018</font></p>
<p lang="da-DK" class="western" align="center" style="margin-bottom: 0in">
<br/>

</p>
<p lang="da-DK" align="center" style="margin-left: 0.17in; margin-bottom: 0in; page-break-before: always">
<br/>

</p>
<p lang="da-DK" align="center" style="margin-left: 0.17in; margin-bottom: 0in">
<br/>

</p>
<div id="Table of Contents1" dir="ltr">
	<p lang="da-DK" align="center" style="margin-left: 0.17in; margin-bottom: 0in">
	<font size="4" style="font-size: 15pt"><b><a class="western" href="#__RefHeading___Toc520367526"><span style="letter-spacing: 0.4pt">1.</span></a></b><font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US"><span style="font-weight: normal"><a class="western" href="#__RefHeading___Toc520367526">	</a></span></span></font></font><a class="western" href="#__RefHeading___Toc520367526"><b><span style="letter-spacing: 0.4pt">Introduction</span><span lang="en-US">	5</span></b></a></font></p>
	<p lang="da-DK" align="center" style="margin-left: 0.17in; margin-bottom: 0in">
	<font size="4" style="font-size: 15pt"><b><a class="western" href="#__RefHeading___Toc520367527"><span style="letter-spacing: 0.4pt">2.</span></a></b><font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US"><span style="font-weight: normal"><a class="western" href="#__RefHeading___Toc520367527">	</a></span></span></font></font><a class="western" href="#__RefHeading___Toc520367527"><b><span style="letter-spacing: 0.4pt">Features</span><span lang="en-US">	6</span></b></a></font></p>
	<p lang="da-DK" align="center" style="margin-left: 0.17in; margin-bottom: 0in">
	<font size="4" style="font-size: 15pt"><b><a class="western" href="#__RefHeading___Toc520367528"><span style="letter-spacing: 0.4pt">3.</span></a></b><font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US"><span style="font-weight: normal"><a class="western" href="#__RefHeading___Toc520367528">	</a></span></span></font></font><a class="western" href="#__RefHeading___Toc520367528"><b><span style="letter-spacing: 0.4pt">API</span><span lang="en-US">	7</span></b></a></font></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367529">3.1.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>TSS_Execute()<span lang="en-US">	7</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367530">3.2.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>TSS_Create()<span lang="en-US">	7</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367531">3.3.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>TSS_Delete()<span lang="en-US">	8</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367532">3.4.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Optional
	Customization<span lang="en-US">	9</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367533">3.4.1.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Property
	Example<span lang="en-US">	9</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367534">3.4.2.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Properties<span lang="en-US">	9</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367535">3.4.3.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>TSS_SetProperty()<span lang="en-US">	12</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367536">3.5.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Extra
	Parameter<span lang="en-US">	13</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367537">3.6.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Other
	APIs and Headers<span lang="en-US">	13</span></a></p>
	<p lang="da-DK" align="center" style="margin-left: 0.17in; margin-bottom: 0in">
	<font size="4" style="font-size: 15pt"><b><a class="western" href="#__RefHeading___Toc520367538"><span style="letter-spacing: 0.4pt">4.</span></a></b><font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US"><span style="font-weight: normal"><a class="western" href="#__RefHeading___Toc520367538">	</a></span></span></font></font><a class="western" href="#__RefHeading___Toc520367538"><b><span style="letter-spacing: 0.4pt">Application
	Notes</span><span lang="en-US">	15</span></b></a></font></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367539">4.1.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>TPM
	Simulator<span lang="en-US">	15</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367540">4.2.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Parameter
	Encryption<span lang="en-US">	15</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367541">4.3.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Session
	Salt<span lang="en-US">	15</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367542">4.4.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Session
	Bind<span lang="en-US">	15</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367543">4.5.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>NV<span lang="en-US">	16</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367544">4.5.1.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Rationale<span lang="en-US">	16</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367545">4.5.2.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>NV
	Pre-provisioning<span lang="en-US">	17</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367546">4.6.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>TPM2_LoadExternal<span lang="en-US">	17</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367547">4.7.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Connecting
	to Resource Managers<span lang="en-US">	17</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367548">4.8.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Endorsement
	Key (EK) Certificates<span lang="en-US">	18</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367549">4.8.1.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Nuvoton<span lang="en-US">	18</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367550">4.8.2.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>St
	Micro<span lang="en-US">	18</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367551">4.8.3.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Infineon<span lang="en-US">	19</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367552">4.8.4.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>NationZ<span lang="en-US">	20</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367553">4.8.5.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Intel<span lang="en-US">	20</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367554">4.8.5.1.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Intel
	EK Certificate Download<span lang="en-US">	20</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367555">4.9.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Command
	Line Utilities<span lang="en-US">	21</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367556">4.10.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>TSS
	for TPM 1.2<span lang="en-US">	21</span></a></p>
	<p lang="da-DK" align="center" style="margin-left: 0.17in; margin-bottom: 0in">
	<font size="4" style="font-size: 15pt"><b><a class="western" href="#__RefHeading___Toc520367557"><span style="letter-spacing: 0.4pt">5.</span></a></b><font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US"><span style="font-weight: normal"><a class="western" href="#__RefHeading___Toc520367557">	</a></span></span></font></font><a class="western" href="#__RefHeading___Toc520367557"><b><span style="letter-spacing: 0.4pt">Example</span><span lang="en-US">	23</span></b></a></font></p>
	<p lang="da-DK" align="center" style="margin-left: 0.17in; margin-bottom: 0in">
	<font size="4" style="font-size: 15pt"><b><a class="western" href="#__RefHeading___Toc520367558"><span style="letter-spacing: 0.4pt">6.</span></a></b><font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US"><span style="font-weight: normal"><a class="western" href="#__RefHeading___Toc520367558">	</a></span></span></font></font><a class="western" href="#__RefHeading___Toc520367558"><b><span style="letter-spacing: 0.4pt">Build</span><span lang="en-US">	24</span></b></a></font></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367559">6.1.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Build
	Options<span lang="en-US">	24</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367560">6.1.1.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>TPM_TPM20
	and TPM_TPM12<span lang="en-US">	24</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367561">6.1.2.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>TPM_POSIX
	or TPM_WINDOWS<span lang="en-US">	24</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367562">6.1.3.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>TPM_WINDOWS_TBSI<span lang="en-US">	24</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367563">6.1.4.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>TPM_WINDOWS_TBSI_WIN8<span lang="en-US">	24</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367564">6.1.5.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>TPM_WINDOWS_TBSI_WIN7<span lang="en-US">	24</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367565">6.1.6.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>TPM_TSS_NOFILE<span lang="en-US">	24</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367566">6.1.7.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>TPM_TSS_NOCRYPTO<span lang="en-US">	25</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367567">6.1.8.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>TPM_TSS_NO_PRINT<span lang="en-US">	25</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367568">6.1.9.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>TPM_TSS_NOECC<span lang="en-US">	25</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367569">6.2.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Directories<span lang="en-US">	25</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367570">6.3.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Linux<span lang="en-US">	26</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367571">6.4.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Windows<span lang="en-US">	26</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367572">6.4.1.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Windows
	Tbsi<span lang="en-US">	27</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367573">6.4.2.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Windows
	Visual Studio<span lang="en-US">	28</span></a></p>
	<p style="margin-left: 0.33in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367574">6.4.3.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Windows
	gcc<span lang="en-US">	29</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367575">6.5.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Mac<span lang="en-US">	29</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367576">6.6.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>AIX<span lang="en-US">	30</span></a></p>
	<p lang="da-DK" align="center" style="margin-left: 0.17in; margin-bottom: 0in">
	<font size="4" style="font-size: 15pt"><b><a class="western" href="#__RefHeading___Toc520367577"><span style="letter-spacing: 0.4pt">7.</span></a></b><font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US"><span style="font-weight: normal"><a class="western" href="#__RefHeading___Toc520367577">	</a></span></span></font></font><a class="western" href="#__RefHeading___Toc520367577"><b><span style="letter-spacing: 0.4pt">Fedora</span><span lang="en-US">	31</span></b></a></font></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367578">7.1.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Local
	Install<span lang="en-US">	31</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367579">7.2.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Alternative
	Local Install<span lang="en-US">	31</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367580">7.3.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Repository
	Install<span lang="en-US">	32</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367581">7.4.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Install
	Test<span lang="en-US">	32</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367582">7.5.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Source
	rpms<span lang="en-US">	32</span></a></p>
	<p lang="da-DK" align="center" style="margin-left: 0.17in; margin-bottom: 0in">
	<font size="4" style="font-size: 15pt"><b><a class="western" href="#__RefHeading___Toc520367583"><span style="letter-spacing: 0.4pt">8.</span></a></b><font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US"><span style="font-weight: normal"><a class="western" href="#__RefHeading___Toc520367583">	</a></span></span></font></font><a class="western" href="#__RefHeading___Toc520367583"><b><span style="letter-spacing: 0.4pt">Status</span><span lang="en-US">	34</span></b></a></font></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367584">8.1.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Utilities<span lang="en-US">	34</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367585">8.2.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Bugs<span lang="en-US">	34</span></a></p>
	<p style="margin-left: 0.17in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc520367586">8.3.<font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US">	</span></font></font>Untested<span lang="en-US">	34</span></a></p>
	<p lang="da-DK" align="center" style="margin-left: 0.17in; margin-bottom: 0in">
	<font size="4" style="font-size: 15pt"><b><a class="western" href="#__RefHeading___Toc520367587"><span style="letter-spacing: 0.4pt">9.</span></a></b><font face="Calibri, sans-serif"><font size="2" style="font-size: 11pt"><span lang="en-US"><span style="font-weight: normal"><a class="western" href="#__RefHeading___Toc520367587">	</a></span></span></font></font><a class="western" href="#__RefHeading___Toc520367587"><b><span style="letter-spacing: 0.4pt">Theading</span><span lang="en-US">	35</span></b></a></font></p>
</div>
<p class="western" style="margin-bottom: 0in"><a name="_Ref166921735"></a>
<br/>

</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<li/>
<h1 class="western" align="justify" style="margin-top: 0.25in; margin-bottom: 0.17in; letter-spacing: 0.4pt; page-break-before: always"><a name="__RefHeading___Toc520367526"></a>
	<font size="2" style="font-size: 11pt">Introduction</font></h1>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The IBM TSS is designed
for:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">ease of
	understanding</p>
	<li/>
<p class="western" style="margin-bottom: 0in">ease of use</p>
	<li/>
<p class="western" style="margin-bottom: 0in">ease of
	implementation</p>
	<li/>
<p class="western" style="margin-bottom: 0in">maximum code
	reuse</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The package is
upstreamed to</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">Fedora</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Debian</p>
	<li/>
<p class="western" style="margin-bottom: 0in">RHEL 7.4 and up</p>
	<li/>
<p class="western" style="margin-bottom: 0in">SLES 12 SP3 and
	up</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Ubuntu 17.10 and
	up</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol start="2">
	<li/>
<h1 class="western" align="justify" style="margin-top: 0.25in; margin-bottom: 0.17in; letter-spacing: 0.4pt; page-break-before: always"><a name="__RefHeading___Toc520367527"></a>
	<font size="2" style="font-size: 11pt">Features</font></h1>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The TSS handles the
following, completely hidden from the caller:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">HMAC, password
	and policy sessions</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Session and HMAC
	key calculations, including bind and salt sessions</p>
	<li/>
<p class="western" style="margin-bottom: 0in">HMAC generation
	and verification (including cpHash and rpHash)</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Parameter
	encryption and decryption, XOR and AES</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Nonces and nonce
	rolling</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Session continue
	flag</p>
	<li/>
<p class="western" style="margin-bottom: 0in">TPM 2.0 &quot;Name&quot;
	and bind session tracking</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Different
	session hash algorithms</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Marshaling,
	unmarshaling, and communication with the TPM 
	</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">and almost hidden from
the caller:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">bind password</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol start="3">
	<li/>
<h1 class="western" align="justify" style="margin-top: 0.25in; margin-bottom: 0.17in; letter-spacing: 0.4pt; page-break-before: always"><a name="__RefHeading___Toc520367528"></a><a name="_Ref511735765"></a><a name="_Ref511735763"></a>
	<font size="2" style="font-size: 11pt">API</font></h1>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The API consists of the
following calls:</p>
<ol>
	<ol>
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367529"></a>
		TSS_Execute()</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">#include
&lt;ibmtss2/tss.h&gt;</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">TPM_RC
	TSS_Execute(TSS_CONTEXT 			*tssContext,</p>
<p class="western" style="margin-left: 0.5in; margin-bottom: 0in">		 
         RESPONSE_PARAMETERS 	*out,</p>
<p class="western" style="margin-bottom: 0in">				COMMAND_PARAMETERS
	*in,</p>
<p class="western" style="margin-bottom: 0in">				EXTRA_PARAMETERS
		*extra,</p>
<p class="western" style="margin-bottom: 0in">				TPM_CC
				commandCode,</p>
<p class="western" style="margin-bottom: 0in">		  	 	...);</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">This is the primary TSS
function.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">tssContext:  Opaque
object</p>
<p class="western" style="margin-bottom: 0in">out:  The standard TPM2
Part 3 response parameter</p>
<p class="western" style="margin-bottom: 0in">in: The standard TPM2
Part 3 command parameter</p>
<p class="western" style="margin-bottom: 0in">extra:  Some commands
(only two so far) require extra parameter s.</p>
<p class="western" style="margin-bottom: 0in">commandCode: The
standard TPM2 Part 2 command code.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">. . . :  A list of
session 3-tuples , of the form</p>
<p class="western" style="margin-bottom: 0in">	 TPMI_SH_AUTH_SESSION
sessionHandle,</p>
<p class="western" style="margin-bottom: 0in">   	const char
*password,</p>
<p class="western" style="margin-bottom: 0in">   	unsigned int
sessionAttributes</p>
<p class="western" style="margin-bottom: 0in">	The list is terminated
with (TPM_RH_NULL, NULL, 0)</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="2">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367530"></a><a name="_Ref437348825"></a>
		TSS_Create()</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">#include
&lt;ibmtss2/tss.h&gt;</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">TPM_RC
	TSS_Create(TSS_CONTEXT **tssContext);</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">This creates the
TSS_CONTEXT used in the TSS_Execute() function.  It is initialized
with the default configuration, which can be then changed using 3.4.3
TSS_SetProperty().</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Returns an error if the
context cannot be allocated, or if the properties cannot be
initialized, typically due to an invalid environment variable.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">See 3.3 TSS_Delete().</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">It does not immediately
open a connection, so that the connection properties can be changed
from the default first. 
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="3">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367531"></a><a name="_Ref437348811"></a>
		TSS_Delete()</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">#include
&lt;ibmtss2/tss.h&gt;</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">TPM_RC	TSS_Delete(TSS_CONTEXT
*tssContext);</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The deletes the opaque
context created using 3.2 TSS_Create().  
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">It closes an open
connection.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Returns an error if the
connection close fails.</p>
<p class="western" style="margin-bottom: 0in; page-break-before: always">
<br/>

</p>
<ol>
	<ol start="4">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367532"></a>
		Optional Customization</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The TSS is designed to
work by default with no configuration.   
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-left: 0.25in; margin-bottom: 0in">The
current default connects to the Microsoft format socket simulation. 
This will eventually change to connect to the resource manager.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">There are three ways to
customize the configuration:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<li/>
<p class="western" style="margin-bottom: 0in">At compile time,
	with a compiler flag</p>
	<li/>
<p class="western" style="margin-bottom: 0in">At program
	start, using an environment variable</p>
	<li/>
<p class="western" style="margin-bottom: 0in">During run time,
	using the 3.4.3 TSS_SetProperty() function.</p>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The environment
variables and TSS_SetProperty property use the same names.  The
makefile flag uses the name with _DEFAULT appended.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The environment
variable overrides the compiler flag, and the TSS_SetProperty()
function overrides both the compiler flag and the environment
variable.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol>
		<ol>
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367533"></a>
			Property Example</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">To change the default
TPM interface to the TPM device driver:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">With a makefile:</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">-DTPM_INTERFACE_TYPE_DEFAULT=&quot;\&quot;dev\&quot;&quot;</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">With an
	environment variable:</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">&gt; setenv
TPM_INTERFACE_TYPE  dev</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">With the TSS_SetProperty()
	function:</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">rc =
TSS_SetProperty(tssContext, TPM_INTERFACE_TYPE, &quot;dev&quot;);</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol>
		<ol start="2">
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367534"></a><a name="_Ref469903681"></a><a name="_Ref469903677"></a>
			Properties</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">(Remember that the
makefile compiler flag requires _DEFAULT to be added, and that the
quotes must be escaped.).</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The property and legal
values are:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<h4 class="western"><a name="_Ref473273918"></a>TPM_TRACE_LEVEL</h4>
<p class="western" style="margin-bottom: 0in">		default -  0</p>
<p class="western" style="margin-bottom: 0in">	0 - no tracing</p>
<p class="western" style="margin-bottom: 0in">	1 - trace errors</p>
<p class="western" style="margin-bottom: 0in">	2 - trace errors and
execution flow</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<h4 class="western">TPM_DATA_DIR</h4>
<p class="western" style="margin-bottom: 0in">		default - current
directory</p>
<p class="western" style="margin-bottom: 0in">	set the directory
where the TSS can store persistent data</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<h4 class="western"><a name="_Ref473274005"></a>TPM_INTERFACE_TYPE</h4>
<p class="western" style="margin-bottom: 0in">		default - socsim 
</p>
<p class="western" style="margin-bottom: 0in">	socsim - the socket
simulator</p>
<p class="western" style="margin-left: 1in; margin-bottom: 0in">see 
</p>
<p class="western" style="margin-left: 1in; text-indent: 0.5in; margin-bottom: 0in">
TPM_SERVER_NAME</p>
<p class="western" style="margin-left: 1in; text-indent: 0.5in; margin-bottom: 0in">
TPM_SERVER_TYPE</p>
<p class="western" style="margin-left: 1in; text-indent: 0.5in; margin-bottom: 0in">
TPM_COMMAND_PORT</p>
<p class="western" style="margin-left: 1in; text-indent: 0.5in; margin-bottom: 0in">
TPM_PLATFORM_PORT</p>
<p class="western" style="margin-bottom: 0in">	dev - TPM device
driver 
</p>
<p class="western" style="margin-left: 0.5in; text-indent: 0.5in; margin-bottom: 0in">
see 
</p>
<p class="western" style="margin-left: 1in; text-indent: 0.5in; margin-bottom: 0in">
TPM_DEVICE</p>
<h4 class="western"><a name="_Ref473273410"></a>TPM_SERVER_NAME</h4>
<p class="western" style="margin-bottom: 0in">		default - localhost</p>
<p class="western" style="margin-bottom: 0in">	set the socket server
name (full host name or dotted decimal)</p>
<h4 class="western"><a name="_Ref473273447"></a>TPM_SERVER_TYPE</h4>
<p class="western" style="margin-bottom: 0in">	Used with
TPM_INTERFACE_TYPE = socsim</p>
<p class="western" style="margin-bottom: 0in">		default - mssim</p>
<p class="western" style="margin-bottom: 0in">	mssim - send packets
in the Microsoft simulator format (header and footer)</p>
<p class="western" style="margin-bottom: 0in">	raw - send packets in
the raw TPM 2.0 specification Part 3 format</p>
<p class="western" style="margin-bottom: 0in">	rawsingle - same as
raw but opens and closes the connection for each command</p>
<p class="western" style="margin-bottom: 0in">		(useful with the IBM
SW TPM 1.2 simulator)</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<h4 class="western"><a name="_Ref473273450"></a>TPM_COMMAND_PORT</h4>
<p class="western" style="margin-bottom: 0in">		default - 2321</p>
<p class="western" style="margin-bottom: 0in">	set the socket port
for TPM commands</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<h4 class="western"><a name="_Ref473273453"></a>TPM_PLATFORM_PORT</h4>
<p class="western" style="margin-bottom: 0in">		default - 2322</p>
<p class="western" style="margin-bottom: 0in">	set the socket port
for TPM simulator platform commands</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<h4 class="western"><a name="_Ref473273499"></a>TPM_DEVICE</h4>
<p class="western" style="margin-bottom: 0in">		Unix/Linux default -
/dev/tpm0	(single user)</p>
<p class="western" style="margin-bottom: 0in">		Windows default -
Windows 7,8,10 Tbsi</p>
<p class="western" style="margin-bottom: 0in">	For Unix, sets the TPM
device name</p>
<p class="western" style="margin-bottom: 0in">		/dev/tpmrm0 is the
multi-user kernel resource manager</p>
<p class="western" style="margin-bottom: 0in">			Once the kernel
resource manager is upstreamed, this</p>
<p class="western" style="margin-bottom: 0in">			may become the
default.</p>
<p class="western" style="margin-bottom: 0in">	For Windows, not
currently used, only Tbsi supported</p>
<p class="western" style="margin-bottom: 0in">	</p>
<h4 class="western"><a name="_Ref473274288"></a>TPM_ENCRYPT_SESSIONS</h4>
<p class="western" style="margin-bottom: 0in">		default 1</p>
<p class="western" style="margin-bottom: 0in">	1 - Session state is
saved encrypted</p>
<p class="western" style="margin-bottom: 0in">	0 - Session state is
saved in plaintext</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Since session state can
potentially hold secrets, it should normally be encrypted.  When the
process terminates, the ephemeral encryption key is lost.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">See 4.9 Command Line Utilities
for the special case of using the command line utilities.  That
section is not applicable when using the TSS library in programs.</p>
<p class="western" style="margin-bottom: 0in; page-break-before: always">
<br/>

</p>
<ol>
	<ol>
		<ol start="3">
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367535"></a><a name="_Ref418692484"></a>
			TSS_SetProperty()</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">#include
&lt;ibmtss2/tss.h&gt;</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">TPM_RC
TSS_SetProperty(TSS_CONTEXT *tssContext,</p>
<p class="western" style="margin-left: 1.5in; text-indent: 0.5in; margin-bottom: 0in">
int property,</p>
<p class="western" style="margin-left: 1.5in; text-indent: 0.5in; margin-bottom: 0in">
const char *value);</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The TSS_SetProperty()
function overrides the defaults and environment variables
programmatically.  
</p>
<p class="western" style="margin-bottom: 0in">	</p>
<p class="western" style="margin-bottom: 0in">If the property is
related to the connection, an open connection is closed before the
property is processed.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-left: 0.5in; margin-bottom: 0in">NOTE:
 The close occurs even if the new value is the same as the old value.
 This can be used to close a connection without deleting the context.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-left: 0.5in; margin-bottom: 0in">Question:
 Is it good to mandate this behavior?  It offers functionality and
makes the implementation easier, but perhaps it's too clever?</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">NOTE:  The value
parameter is always a string. For simplicity, the 'value' pointer is
stored.  The input should be a constant string.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">NOTE: For the property
TPM_TRACE_LEVEL, tssContext is ignored.  The trace level is per
process, not per context.</p>
<p class="western" style="margin-bottom: 0in; page-break-before: always">
<br/>

</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="5">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367536"></a>
		Extra Parameter</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The extra parameter is
a catch-all for any parameters that TSS_Execute() requires beyond the
normal TPM command and response parameters.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">TPM2_StartAuthSession
needs the bind password so that it can calculate the session key. 
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="6">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367537"></a>
		Other APIs and Headers</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Headers are in the
&hellip;/utils/ibmtss2 directory.  
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">#include
&lt;ibmtss2/tss.h&gt;</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The utility / demo
applications cheat a bit, in that they call into TSS utility
functions.  These are less likely to be stable than the official API
above.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">tss.h:  The
	official API</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">tsserror.h: 
	Included by tss.h for convenience.  Error codes may be added.</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">tssmarshal.h: 
	Marshal structures to arrays. These are likely to be stable.  They
	are similar to the TPM side functions but return errors.</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">Unmarshal_fp.h:
	Unmarshal arrays to structures.  
	</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-left: 0.5in; margin-bottom: 0in">The
functions without the TSS_ prefix are deprecated.  They were borrowed
from the TPM side, but used a signed value for the size.  The
functions prefixed TSS_ use an unsigned value for the size.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">tssresponsecode.h:
	 Response code to text.  Useful for debugging.  The API should be
	stable, but the actual output may change.</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">tssprint.h: 
	Functions to print structures.  Useful for debugging.  The API
	should be stable.  Functions may be added, and the output is likely
	to change.</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">tssprintcmd.h: 
	Functions to print command parameters.  Used in TSS verbose tracing.
	 The API should be stable, but the actual output may change.</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">tssutils.h: 
	Demo helper functions.  These are useful for rapid prototyping but
	are not recommended for production code.</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">tssfile.h:  Demo
	helper functions.  These are useful for rapid prototyping but are
	not recommended for production code.</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">tsscrypto.h: 
	Sample crypto code.  These are useful for rapid prototyping but are
	not recommended for production code.</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">Any of the lower
	layer TSS functions are for TSS internal use.  They should not be
	called.</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol start="4">
	<li/>
<h1 class="western" align="justify" style="margin-top: 0.25in; margin-bottom: 0.17in; letter-spacing: 0.4pt; page-break-before: always"><a name="__RefHeading___Toc520367538"></a>
	<font size="2" style="font-size: 11pt">Application Notes</font></h1>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Several areas have
non-obvious usage.  They are described here.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol>
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367539"></a>
		TPM Simulator</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">A typical cause of a
hang when sending the first command to the TPM simulator is that it
has not received a simulated &quot;powered up.&quot;  Send this
command:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">&gt; powerup</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The platform firmware
initializes a hardware TPM.  The TPM simulator requires this command:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">&gt; startup</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="2">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367540"></a>
		Parameter Encryption</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The caller does NOT
perform parameter encryption.  Simply set the session attribute to
either or both of TPMA_SESSION_ENCRYPT or TPMA_SESSION_DECRYPT.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="3">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367541"></a>
		Session Salt</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">To salt, the caller
should set tpmKey (the handle of a loaded decrypt key) in
TPM2_StartAuthSession.  The key must be an RSA 2048-bit key or ECC
NIST P256 key with sign clear and decrypt set.  
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The caller must supply
the extra parameter as a StartAuthSession_Extra structure.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The caller does NOT
supply the HMAC salt.  The encryptedSalt parameter is ignored, as the
TSS generates the salt.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="4">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367542"></a>
		Session Bind</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">To bind, the caller
should set bind (the bind entity handle) in TPM2_StartAuthSession. 
The caller must supply the extra parameter as a
StartAuthSession_Extra structure and set the bindPassword member to
the bind handle password.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="5">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367543"></a>
		NV</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">For applications that
do not share an NV index and don't use global locks or transient
locks that change after a reboot, the following details are
unnecessary.  Just issue the TPM2_NV_DefineSpace and everything
works, including HMAC sessions.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">For applications that
do not satisfy the above criteria, the application must issue
TPM2_NV_ReadPublic and validate that the public area is as expected,
including the locks.</p>
<ol>
	<ol>
		<ol>
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367544"></a>
			Rationale</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Why?  For
authorization, the TSS includes the Name (a hash of the public NV
metadata) in the HMAC calculation.  This ensures that the NV index
has not been replaced with a different version with untrusted
metadata.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Normally, the TSS
tracks the Name, even when the application changes the written or
lock attributes.  However, if the attributes (and therefore the Name)
change outside the application, the TSS is unable to track the
change.  In those cases, the application must read the public data
and validate it.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Why doesn't the TSS
automatically issue the TPM2_NV_ReadPublic?  If it did that, it would
encourage the application developer to blindly trust the index.  The
application is expected to examine the TPM2_NV_ReadPublic return
(e.g., the policy, the attributes) and decide whether the index is
trusted.  The TSS cannot enforce this, but it does at least encourage
it.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The index Name can
change as the metadata changes.  These changes include the &quot;written&quot;
bit and the read and write locks.  The TSS automatically tracks the
changes performed on a single index by the application.  It does not
track:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<li/>
<p class="western" style="margin-bottom: 0in">Changes &quot;out
	of band&quot;, by a different application, including an attacker.</p>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">This will surface as an
HMAC failure.  The application should reissue TPM2_NV_ReadPublic and
decide if the index is still trusted.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol start="2">
	<li/>
<p class="western" style="margin-bottom: 0in">Changes to
	transient lock status due to a reboot.</p>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">If the application is
aware of the reboot, it can reissue TPM2_NV_ReadPublic and
re-evaluate the return.  Otherwise, it can wait for the potential
HMAC failure and handle it as above.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol start="3">
	<li/>
<p class="western" style="margin-bottom: 0in">Locks due to a
	global lock, because it's hard and because global lock is expected
	to be used only at provisioning, if ever.</p>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">This case will probably
never occur in practice.  If it does, handle the HMAC failure as
above.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol>
		<ol start="2">
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367545"></a>
			NV Pre-provisioning</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">This is the case where
some other application has used TPM2_NV_DefineSpace to pre-provision
an index.  As an alternative to the application evaluating the
TPM2_NV_ReadPublic response, the NV metadata and Name can be
pre-provisioned when the application is installed.  Two files are
required:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">	[01nnnnnn] is the hex
value of the NV index.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<li/>
<p class="western" style="margin-bottom: 0in">h[01nnnnnn].bin
	- The Name, a binary hash of the public data</p>
	<li/>
<p class="western" style="margin-bottom: 0in">nvp[01nnnnnn].bin
	- The marshaled TPMS_NV_Public</p>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="6">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367546"></a>
		TPM2_LoadExternal</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">This command is unique,
in that it has an optional parameter, TPM2B_SENSITIVE <i>inPrivate</i>.
 The caller should use the size as a flag:  0 for not present, and
non-zero for present.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Rationale:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The TPM uses the
<i>inPrivate.size </i>zero to indicate that the parameter is not
present, and uses the correct marshaled size to indicate that the
parameter is present. This TSS uses that design pattern, but, as with
other TPM2B's that wrap structures, it does not require the caller to
marshal the structure and determine the correct size.  
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="7">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367547"></a><a name="_Ref483554623"></a><a name="_Ref483554619"></a>
		Connecting to Resource Managers</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">An issue arises when
using the TSS utilities (not the TSS itself) on a platform with a
resource manager.  Windows currently has a resource manager (called
TBS) and all OSes will eventually have one.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">A resource manager
flushes all resources (objects like keys, and sessions) when a
connection closes.  Since the utilities are standalone processes, the
connection closes after each invocation.  Thus, for example, a
utility can load a key, but, when the &quot;load&quot; command
terminates, the resource manager will flush the key.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">This is not an issue
for a complete application using the TSS, because the TSS will keep
the connection open through multiple TPM commands.  For prototyping
using the utilities, the solution is to simulate this persistent
connection behavior.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The &quot;tpm_proxy&quot;
program connects as a socket server on one side and a TPM device
driver on the other.  Once the proxy starts, the resource manager
sees one persistent connection, as desired.  The utilities use the
socket interface to the proxy.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The proxy (for both TPM
1.2 and TPM 2.0) is part of the tarball at</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><font color="#0000ff"><span lang="en-US"><u><a class="western" href="https://sourceforge.net/projects/ibmswtpm/files/?source=navbar"><span lang="en-US">https://sourceforge.net/projects/ibmswtpm/files/?source=navbar</span></a></u></span></font></p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">It is not well tested
for TPM 2.0.  I expect that the TPM_Startup call must be commented
out, and that the TSS must run in &quot;raw&quot; mode.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="8">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367548"></a>
		Endorsement Key (EK) Certificates</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The TSS includes
several TPM vendor EK root certificates for convenience.  
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">There is no reason for
a user to trust these certificates.  Obtain production certificates
directly from the TPM vendor.  
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">These URLs are provided
for convenience.  Observe that some URLs are http.  I encourage all
readers to ask the TPM vendors to offer these certificates over a
secured web page, since they form the root of trust for TPM
authenticity.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Utilities such as
&quot;createek&quot; that take a -root argument require a list of EK
root certificates in a file.  The utilities include a sample file
&hellip;/utils/certificates/rootcerts.txt.  The file MUST be edited,
since the file names must have a complete path to your install
directory.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Certificates must be in
PEM format.  To convert from DER format (.cer, .crt) to PEM using
openssl:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">&gt; openssl x509 -in
cert.cer -inform DER -out cert.pem</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol>
		<ol>
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367549"></a>
			Nuvoton</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><font color="#0000ff"><span lang="en-US"><u><a class="western" href="https://www.nuvoton.com/security/NTC-TPM-EK-Cert/Nuvoton%20TPM%20Root%20CA%202110.cer"><span lang="en-US">https://www.nuvoton.com/security/NTC-TPM-EK-Cert/Nuvoton%20TPM%20Root%20CA%202110.cer</span></a></u></span></font></p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><font color="#0000ff"><span lang="en-US"><u><a class="western" href="https://www.nuvoton.com/security/NTC-TPM-EK-Cert/Nuvoton%20TPM%20Root%20CA%201110.cer"><span lang="en-US">https://www.nuvoton.com/security/NTC-TPM-EK-Cert/Nuvoton%20TPM%20Root%20CA%201110.cer</span></a></u></span></font></p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol>
		<ol start="2">
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367550"></a>
			St Micro</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">This list was extracted
from http://www.st.com/resource/en/data_brief/stsw-tpmcert1.pdf</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">GlobalSign Trusted
Computing CA 
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><font color="#0000ff"><span lang="en-US"><u><span lang="en-US">http://secure.globalsign.com/cacert/gstpmroot.crt</span></u></span></font></p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">ST TPM Root certificate
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><font color="#0000ff"><span lang="en-US"><u><span lang="en-US">http://secure.globalsign.com/cacert/stmtpmekroot.crt</span></u></span></font></p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">ST Intermediate CA 01 
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><font color="#0000ff"><span lang="en-US"><u><span lang="en-US">http://secure.globalsign.com/cacert/stmtpmekint01.crt</span></u></span></font></p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">ST Intermediate CA 02 
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><font color="#0000ff"><span lang="en-US"><u><span lang="en-US">http://secure.globalsign.com/cacert/stmtpmekint02.crt</span></u></span></font></p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">ST Intermediate CA 03 
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><font color="#0000ff"><span lang="en-US"><u><span lang="en-US">http://secure.globalsign.com/cacert/stmtpmekint03.crt</span></u></span></font></p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">ST Intermediate CA 04 
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><font color="#0000ff"><span lang="en-US"><u><span lang="en-US">http://secure.globalsign.com/cacert/stmtpmekint04.crt</span></u></span></font></p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">ST Intermediate CA 05 
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><font color="#0000ff"><span lang="en-US"><u><span lang="en-US">http://secure.globalsign.com/cacert/stmtpmekint05.crt</span></u></span></font></p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">GlobalSign Trusted
Platform Module ECC</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Root CA 
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><font color="#0000ff"><span lang="en-US"><u><span lang="en-US">http://secure.globalsign.com/cacert/tpmeccroot.crt</span></u></span></font></p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">STM TPM ECC Root CA 01 
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><font color="#0000ff"><span lang="en-US"><u><span lang="en-US">http://secure.globalsign.com/stmtpmeccroot01.crt</span></u></span></font></p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">STM TPM ECC
Intermediate CA 01 
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><font color="#0000ff"><span lang="en-US"><u><span lang="en-US">http://secure.globalsign.com/stmtpmeccint01.crt</span></u></span></font></p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol>
		<ol start="3">
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367551"></a>
			Infineon</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><font color="#0000ff"><span lang="en-US"><u><a class="western" href="https://www.infineon.com/cms/en/product/promopages/optiga_tpm_certificates"><span lang="en-US">https://www.infineon.com/cms/en/product/promopages/optiga_tpm_certificates</span></a></u></span></font></p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol>
		<ol start="4">
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367552"></a>
			NationZ</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Root</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><font color="#0000ff"><span lang="en-US"><u><span lang="en-US">https://pki.nationz.com.cn/EkRootCA/EkRootCA.crt</span></u></span></font></p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Intermediate
certificates</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><font color="#0000ff"><span lang="en-US"><u><span lang="en-US">https://pki.nationz.com.cn/EkMfrCA001/EkMfrCA001.crt</span></u></span></font></p>
<p class="western" style="margin-bottom: 0in"><font color="#0000ff"><span lang="en-US"><u><span lang="en-US">https://pki.nationz.com.cn/EkMfrCA002/EkMfrCA002.crt</span></u></span></font></p>
<p class="western" style="margin-bottom: 0in"><font color="#0000ff"><span lang="en-US"><u><span lang="en-US">https://pki.nationz.com.cn/EkMfrCA003/EkMfrCA003.crt</span></u></span></font></p>
<ol>
	<ol>
		<ol start="5">
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367553"></a>
			Intel</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">PTT EK Root Certificate</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><font color="#0000ff"><span lang="en-US"><u><span lang="en-US">https://upgrades.intel.com/content/CRL/ekcert/EKRootPublicKey.cer</span></u></span></font></p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">PTT EK Intermediate
Certificate</p>
<p class="western" style="margin-bottom: 0in">      
<font color="#0000ff"><span lang="en-US"><u><a class="western" href="http://upgrades.intel.com/content/CRL/ekcert/SPTHEPIDPROD_EK_Platform_Public_Key.cer"><span lang="en-US">http://upgrades.intel.com/content/CRL/ekcert/SPTHEPIDPROD_EK_Platform_Public_Key.cer</span></a></u></span></font></p>
<ol>
	<ol>
		<ol>
			<ol>
				<li/>
<h3 class="western"><a name="__RefHeading___Toc520367554"></a>
				Intel EK Certificate Download</h3>
			</ol>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">As of June, 2017, the
Intel PTT does not come provisioned with EK certificates.  They must
be downloaded using this procedure.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">Read the EK
	public key</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Construct digest
	data</p>
	<ul>
		<li/>
<p class="western" style="margin-bottom: 0in">For RSA,
		concatenate the public modulus to the default exponent 010001, all
		in binary.</p>
		<li/>
<p class="western" style="margin-bottom: 0in">For ECC, this
		step is currently undocumented.</p>
	</ul>
	<li/>
<p class="western" style="margin-bottom: 0in">Calculate a
	SHA-256 digest of the digest data</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Base64 encode
	the digest</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Convert the
	base64 to URL base64 by changing = to %3D, + to -, and / to _.</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Prepend
	<font color="#0000ff"><span lang="en-US"><u><a class="western" href="https://ekop.intel.com/ekcertservice/"><span lang="en-US">https://ekop.intel.com/ekcertservice/</span></a></u></span></font>
	to form the certificate URL.</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Use a browser to
	display the certificate (or use wget and edit in a text editor)</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Extract the text
	between the &lt;certificate&gt; and &lt;/certificate&gt; to a text
	editor.</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Convert the URL
	base64 to base64 by changing %3D to =, - to +, and _ to /.  Remove
	all newlines.</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Base64 decode to
	create the DER certificate.</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="9">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367555"></a><a name="_Ref469903483"></a>
		Command Line Utilities</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">See also section 4.7 Connecting to Resource Managers.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">As stated in section 3.4.2
Properties, the default is to build the TSS library to encrypt
session state with an ephemeral encryption key that is lost when the
application exits.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">This behavior would
preclude using the command line utilities with sessions, since the
encryption key would change.  There are two facilities to remedy
this.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<li/>
<p class="western" style="margin-bottom: 0in">For stand-alone
	debugging, save session state in plaintext.   For example, use an
	environment variable:</p>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="text-indent: 0.5in; margin-bottom: 0in">&gt;
setenv TPM_ENCRYPT_SESSIONS 0		(csh, tcsh)</p>
<p class="western" style="text-indent: 0.5in; margin-bottom: 0in">&gt;
export TPM_ENCRYPT_SESSIONS=0		(bash)</p>
<p class="western" style="text-indent: 0.5in; margin-bottom: 0in">&gt;
set TPM_ENCRYPT_SESSIONS=0		(windows)</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">	or the equivalent
compile time flag</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">	-DTPM_ENCRYPT_SESSIONS_DEFAULT=&quot;\&quot;0\&quot;&quot;</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol start="2">
	<li/>
<p class="western" style="margin-bottom: 0in">For using the
	command line utilities securely, either stand-alone or in scripts, a
	fixed encryption key can be specified.</p>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="text-indent: 0.5in">In the script:</p>
<p class="western" style="text-indent: 0.5in">TPM_SESSION_ENCKEY=`./getrandom
-by 16 -ns`</p>
<p class="western" style="text-indent: 0.5in">On the command line:</p>
<p class="western" style="text-indent: 0.5in">&gt; setenv
TPM_SESSION_ENCKEY `./getrandom -by 16 -ns`</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="10">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367556"></a><a name="_Ref514762249"></a><a name="_Ref514762246"></a>
		TSS for TPM 1.2</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">This is new code in
2018.  The TSS for TPM 1.2 uses the identical API as in section 3 API,
but with TPM 1.2 structures and ordinals.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">There is currently
support for about 20 TPM 1.2 commands, specifically those commands
that are required to implement an attestation client.  It also
includes support commands to create a SW TPM EK certificate and the
activate identity blob, and to extend firmware and IMA event logs
into a TPM for testing.  More commands can be easily added upon user
request.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">To build a combined TPM
2.0 and TPM 1.2 TSS:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">&gt; make
makefiletpmcclean all builds a combined TPM 2.0 and TPM 1.2 TSS.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">To build a TPM 2.0 only
TSS</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">&gt; make -f
makefiuletpm120 builds a TPM 1.2 TSS.clean all</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">To build a TPM 1.2 only
TSS</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">&gt; make -f
makefiletpm12 clean all</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The utilities and a
basic regression test (reg.sh) are in the ../utils12 directory.  
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The regression test
requires a software TPM 1.2 that is 'straight from the factory' -
with no TPM state.  The reason is that creating the standard TCG EK
certificate requires an unlocked TPM.  Once NV is locked, it can
never be unlocked.  Before running the regression test, remove the
state and restart the TPM.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The standard TPM 1.2 is
opt-in, and is shipped disabled and deactivated.  While the  IBM
software TPM comes with tools to enable and activate the TPM, users
may find it less of a nuisance to use 'makefile-en-ac' to build a TPM
that is already enabled and activated at its first start.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol start="5">
	<li/>
<h1 class="western" align="justify" style="margin-top: 0.25in; margin-bottom: 0.17in; letter-spacing: 0.4pt; page-break-before: always"><a name="__RefHeading___Toc520367557"></a>
	<font size="2" style="font-size: 11pt">Example</font></h1>
</ol>
<p class="western" style="margin-bottom: 0in">Each standalone utility
serves as an example for a single command.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The signapp.c source
shows how several commands can be chained together to form an
application.  It does the following:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">Start an
	authorization HMAC session</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Create a primary
	storage key, using the session</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Create a signing
	key under the storage key</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Load the signing
	key, using the session</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Sign a digest,
	using the session</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Verify the
	signature</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Flush the
	primary key</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Flush the
	signing key</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Flush the
	session</p>
</ul>
<ol start="6">
	<li/>
<h1 class="western" align="justify" style="margin-top: 0.25in; margin-bottom: 0.17in; letter-spacing: 0.4pt; page-break-before: always"><a name="__RefHeading___Toc520367558"></a>
	<font size="2" style="font-size: 11pt">Build</font></h1>
</ol>
<p class="western" style="margin-bottom: 0in">The builds for Linux
and Windows create the TSS shared object / dll and about 110 command
line programs.  The command line programs can be used in a script for
rapid prototyping or as sample usage code.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">There are currently
makefiles for common build options, listed later.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The build files clear
TPM_ENCRYPT_SESSIONS, which is useful for prototyping and regression
testing.  This should be removed for production applications.</p>
<ol>
	<ol>
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367559"></a><a name="_Ref156904153"></a>
		Build Options</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Several compile time
macros permit building a variation of the TSS library.  Features may
be lost, but the tradeoff may be important in some environments.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><font color="#ff0000"><b>Since
the regression test does not function against all builds, some
variations are very lightly tested.  Please report bugs.</b></font></p>
<ol>
	<ol>
		<ol>
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367560"></a>
			TPM_TPM20 and TPM_TPM12</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Define one or both of
these for a TSS that supports TPM 2.0 and/or TPM 1.2.  
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">TPM 1.2 support is
incomplete. See section 4.10 TSS for TPM 1.2.</p>
<ol>
	<ol>
		<ol start="2">
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367561"></a>
			TPM_POSIX or TPM_WINDOWS</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Define one of these for
a POSIX (Linux, AIX, Raspian, zLinux, etc.) or Windows TSS.</p>
<ol>
	<ol>
		<ol start="3">
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367562"></a>
			TPM_WINDOWS_TBSI</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">For Windows, compiles
in hardware TPM support.</p>
<ol>
	<ol>
		<ol start="4">
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367563"></a>
			TPM_WINDOWS_TBSI_WIN8</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">For Windows hardware
TPM support, use the Windows 8/10 API.</p>
<ol>
	<ol>
		<ol start="5">
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367564"></a>
			TPM_WINDOWS_TBSI_WIN7</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">For Windows hardware
TPM support, use the Windows 7 API.</p>
<ol>
	<ol>
		<ol start="6">
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367565"></a>
			TPM_TSS_NOFILE</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Defining this macro
builds a TSS library that does not use files for temporary and
persistent state.  All state is stored in the TSS context and is lost
when the context is deleted.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Drawbacks:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">Scripting, which
	requires state to persist between processes, does not work.</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Names and public
	keys of persistent entities do not persist, so the entities must be
	reread (and revalidated) at each connection.</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Context save and
	load are not implemented yet.</p>
	<li/>
<p class="western" style="margin-bottom: 0in">There are
	currently some fixed size arrays for transient object and session
	state.</p>
</ul>
<ol>
	<ol>
		<ol start="7">
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367566"></a>
			TPM_TSS_NOCRYPTO</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Defining this macro
builds a TSS library that does not depend on a crypto library.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Drawbacks:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">Salted sessions
	do not work.</p>
	<li/>
<p class="western" style="margin-bottom: 0in">HMAC session do
	not work, including policies that require HMAC.</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Encrypt and
	decrypt sessions do not work.</p>
</ul>
<ol>
	<ol>
		<ol start="8">
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367567"></a>
			TPM_TSS_NO_PRINT</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Defining this macro
builds a TSS that does no tracing, and compiles out all print
functions.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol>
		<ol start="9">
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367568"></a>
			TPM_TSS_NOECC</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Defining this macro
builds a TSS that does not require OpenSSL elliptic curve support.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="2">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367569"></a>
		Directories</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The TSS ships with
these directories:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">&hellip;/utils		TSS and
utility / demo applications</p>
<p class="western" style="margin-bottom: 0in">&hellip;/utils/regtests	TSS
regression tests</p>
<p class="western" style="margin-bottom: 0in">&hellip;/utils/policies	TSS
regression test policies and miscellaneous files</p>
<p class="western" style="margin-bottom: 0in">&hellip;/utils/certificates	TPM
vendor EK root certificates</p>
<p class="western" style="margin-bottom: 0in">&hellip;/utils12		utility
/ demo applications and regression test for the TPM 1.2 TSS</p>
<p class="western" style="margin-bottom: 0in">&hellip;/demo		TSS demo
web pages</p>
<p class="western" style="margin-bottom: 0in">&hellip;/tpmutils		TSS
Visual Studio files</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">To extract the tarball</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">&gt; cd &hellip;</p>
<p class="western" style="margin-bottom: 0in">&gt; tar xvf
ibmtssnnn.tar .</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="3">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367570"></a>
		Linux</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">These are the
mainstream TPM 2.0 instructions.  For the new TPM 1.2 support, see
the application note in 4.10 TSS for TPM 1.2.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Install OpenSSL 1.0.x
or  1.1.x.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Note:  OpenSSL 1.1.x
cannot validate early TPM 1.2 EK certificates.  Newer TPM 1.2
certificates and TPM 2.0 certificates validate.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">&gt; cd &hellip;/utils</p>
<p class="western" style="margin-bottom: 0in">&gt; make</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">	Note:  Linux builds
must have TPM_POSIX defined.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">After building, run the
regression test against a running simulator.  -h gives help.   The
Linux version takes about 1 minute.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">&gt; ./reg.sh -a</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The regression test can
run against a <b>software</b> TPM at /dev/tpm0.  It will skip the
power up sequence.  However, it uses the environment variable TPM_INTERFACE_TYPE
as the determination.  If the default TPM_INTERFACE_TYPE was changed
at compile time, the regression test will try the power up sequence
unless the environment variable is also set.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><font color="#ff0000"><b>The
regression test does not run against a hardware TPM</b></font>, since
the platform firmware will have set the platform authorization.  
There are likely to be other errors due to protected or unsupported
TPM features.  
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><font color="#ff0000"><b>Use
the regression test for TSS verification, not as a TPM test tool.</b></font></p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The TPM device driver
normally does not permit non-root access.  Either</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">&gt; chmod 777
/dev/tpm0</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">or run as root or sudo.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="4">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367571"></a>
		Windows</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Install OpenSSL 1.0.x
or 1.1.x.  The usual place to get OpenSSL for Windows is
<font color="#0000ff"><span lang="en-US"><u><a class="western" href="http://slproweb.com/products/Win32OpenSSL.html"><span lang="en-US">http://slproweb.com/products/Win32OpenSSL.html</span></a></u></span></font>.
 There is no need to build / compile from source.  Just run the
downloaded .exe.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Install Win32 OpenSSL,
not the &quot;Light&quot; versions, which I believe do not contain
the development files.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Recent Shining Light
installs point to 
</p>
<p class="western" style="text-indent: 0.5in; margin-bottom: 0in"><br/>

</p>
<p class="western" style="text-indent: 0.5in; margin-bottom: 0in">C:\OpenSSL-Win32
 
</p>
<p class="western" style="text-indent: 0.5in; margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Change this to 
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">	C:\Program
Files\OpenSSL</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">If you chose not to
install OpenSSL in this location, you must fix the build paths.  In
other words, use the recommended location.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">This directory should
be added to the Path environment variable if it's not already there:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="text-indent: 0.25in; margin-bottom: 0in">c:\Program
Files\OpenSSL\bin</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="text-indent: 0.25in; margin-bottom: 0in">Note:
 Windows builds must have TPM_WINDOWS defined.</p>
<p class="western" style="text-indent: 0.25in; margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">I put the OpenSSL DLLs
in the OpenSSL binaries directory.  I don't know if this matters.</p>
<p class="western" style="text-indent: 0.25in; margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Build with Visual
Studio using the solution &hellip;/tpmutils/tpmutils.sln</p>
<p class="western" style="text-indent: 0.25in; margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">After building, run the
regression test against a running simulator.   The Windows version
takes about 15 minutes.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-left: 0.5in; margin-bottom: 0in">The
Windows script assumes that typical command line tools such as touch
and diff are installed.  A typical download location is</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="text-indent: 0.5in; margin-bottom: 0in"><font color="#0000ff"><span lang="en-US"><u><a class="western" href="http://gnuwin32.sourceforge.net/packages.html"><span lang="en-US">http://gnuwin32.sourceforge.net/packages.html</span></a></u></span></font></p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="text-indent: 0.5in; margin-bottom: 0in">See
CoreUtils and DiffUtils.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">&gt; reg.bat</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The regression test
script defaults to the executables being in the same directory as the
script, &hellip;/tpm2/utils.  This is correct for the gcc build, but
not for the Visual Studio build.  To point to those executables, set
this environment variable.  Do not omit the trailing slash.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">&gt; set
TPM_EXE_PATH=..\tpmutils\Debug/</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol>
		<ol>
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367572"></a>
			Windows Tbsi</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">These instructions have
been lightly tested.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The VS project does not
define TPM_WINDOWS_TBSI , so the TSS supposts only the socket
interface.  I.e., users that use only the socket interface may not
want to install Tbsi (Windows TPM Base Services).  Define
TPM_WINDOWS_TBSI to add HW TPM support.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">	Note:  To define the
macro in Visual Studio:</p>
<ol>
	<li/>
<p class="western" style="margin-bottom: 0in">View - Other
	Windows - Property Manager</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Expand one of
	the projects</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Expand Debug (or
	Release if doing a release build)</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Double click
	CommonProperties</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Expand Common
	Properties, then C/C++, then select Preprocessor</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Next to
	Preprocessor Definitions, click the value, then the down arrow, then
	&lt;Edit&gt;</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Add the macro
	TPM_WINDOWS_TBSI</p>
	<li/>
<p class="western" style="margin-bottom: 0in">OK, OK</p>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">To build in Tbsi:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">Install the
	Microsoft Platform SDK or the Windows SDK to get the tbs.h include
	file.</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">Define the
	preprocessor macro TPM_WINDOWS_TBSI</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Define the
	preprocessor macro TPM_WINDOWS_TBSI_WIN8</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-left: 0.5in; margin-bottom: 0in">NOTE:
For Windows 7, the alternate macro TPM_WINDOWS_TBSI_WIN7 uses the TPM
1.2 Tbsi API.  I use it for light testing, but it is probably useless
for a TPM 2.0.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-left: 0.5in; margin-bottom: 0in">Note:
 The TPM_WINDOWS_TBSI_WIN8 macro also supports Windows 10.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">Link the tss
	with Tbs.lib</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="text-indent: 0.5in; margin-bottom: 0in">Note:
 For Windows 7, use c:/progra~1/Micros~2/Windows/v7.1/lib/Tbs.lib</p>
<p class="western" style="text-indent: 0.5in; margin-bottom: 0in"><br/>

</p>
<ol>
	<ol>
		<ol start="2">
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367573"></a>
			Windows Visual Studio</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">VS solution and project
files are supplied.  The Visual Studio 2013 Solution is
&hellip;/tpmutils/tpmutils.sln.  
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">It is currently
configured to compile in the Windows (TPM_WINDOWS) TBSI
(TPM_WINDOWS_TBSI) for Windows 8 (TPM_WINDOWS_TBSI_WIN8).  It links
with Tbs.lib.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The default is to
connect to the socket simulator using the Microsoft simulator packet
format.  To change the default from a SW TPM to a HW TPM, add the
preprocessor definition:</p>
<p class="western" style="text-indent: 0.5in; margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">TPM_INTERFACE_TYPE_DEFAULT=&quot;dev&quot;</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol>
		<ol start="3">
			<li/>
<h3 class="western"><a name="__RefHeading___Toc520367574"></a>
			Windows gcc</h3>
		</ol>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">A mingw (Minimalist GNU
for Windows) makefile.mak is included.  mingw from
<font color="#0000ff"><span lang="en-US"><u><a class="western" href="http://www.mingw.org/"><span lang="en-US">http://www.mingw.org/</span></a></u></span></font>
must be installed.  
</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">winerror.h may have to
be installed in C:\Program Files\MinGW\include</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">If the mingw install
does not come with C:\Program Files\MinGW\include\tbs.h, a lightly
tested file is included in the utils directory.  Copy to C:\Program
Files\MinGW\include.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Uncomment as indicated
in makefile.mak to use the TBSI, either Windows 8 or Windows 7. 
Build using:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">&gt; cd &hellip;/utils</p>
<p class="western" style="margin-bottom: 0in">&gt; make -f
makefile.mak</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="5">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367575"></a>
		Mac</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">This is a contribution.
 I did not test it.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">install homebrew</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">install openssl
	-&gt; brew install openssl</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">install gawk -&gt;
	brew install gawk</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">set PATH of
	shell (terminal):</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-left: 0.25in; margin-bottom: 0in">PATH=/usr/local/Cellar/openssl/1.0.2m/bin/:$PATH</p>
<p class="western" style="margin-left: 0.25in; margin-bottom: 0in">PATH=/usr/local/Cellar/gawk/4.2.0/bin/:$PATH</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-left: 0.25in; margin-bottom: 0in">Make
this permanent by adding to a profile.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">Build using
	makefile.mac</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="6">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367576"></a>
		AIX</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Use gnu make (gmake),
not make.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">&gt; cd &hellip;/utils</p>
<p class="western" style="margin-bottom: 0in">&gt; gmake -f
makefile.aix</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">After building, run the
regression test against a running Microsoft simulator.  -h gives
help.  Since the TPM simulator does not run on AIX yet, set the TPM_SERVER_NAME
environment variable.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">&gt; reg.sh -a</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol start="7">
	<li/>
<h1 class="western" align="justify" style="margin-top: 0.25in; margin-bottom: 0.17in; letter-spacing: 0.4pt; page-break-before: always"><a name="__RefHeading___Toc520367577"></a>
	<font size="2" style="font-size: 11pt">Fedora</font></h1>
</ol>
<p class="western" style="margin-bottom: 0in">This section is only
relevant to a Fedora rpm install.  It is a work in progress, and may
not be 100% correct yet.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The &hellip;/utils
directory holds a sample makefile, makefile.sample that can be
modified for a user application.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Prerequisite:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"># yum install rpm-build</p>
<ol>
	<ol>
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367578"></a>
		Local Install</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Download the rpms:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">TBD</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<li/>
<p class="western" style="margin-bottom: 0in">Install
	binaries:</p>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">the libraries -
	/usr/lib64/libtss.so.0.1and the link /usr/lib64/libtss.so.0</p>
	<li/>
<p class="western" style="margin-bottom: 0in">the utilities -
	/usr/bin/tssxxx.  Note that the installed utilities are namespaced
	with the 'tss' prefix.</p>
	<li/>
<p class="western" style="margin-bottom: 0in">the license -
	/usr/share/doc/tss2ibmtss-nnn/LICENSE</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="text-indent: 0.25in; margin-bottom: 0in">#
rpm -ivh 	tss2ibmtss-nnn-1.el6.x86_64.rpm</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol start="2">
	<li/>
<p class="western" style="margin-bottom: 0in">Install
	development headers:</p>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">the headers -
	/usr/include/ibmtss2 
	</p>
	<li/>
<p class="western" style="margin-bottom: 0in">the library -
	link /usr/lib64/libtss.so 
	</p>
	<li/>
<p class="western" style="margin-bottom: 0in">this
	documentation - /usr/share/doc/tss2ibmtss-devel-nnn/ibmtss.doc</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="text-indent: 0.25in; margin-bottom: 0in">#
rpm -ivh	tss2ibmtss-devel-nnn-1.el6.x86_64.rpm</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol start="3">
	<li/>
<p class="western" style="margin-bottom: 0in">Install debug
	source and support</p>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="text-indent: 0.25in; margin-bottom: 0in">#
rpm -ivh 	tss2ibmtss-debuginfo-nnn-1.el6.x86_64.rpm</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="2">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367579"></a>
		Alternative Local Install</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Erase an old version as
needed:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"># yum erase
tss2ibmtss-devel-nnn-1.el6.x86_64</p>
<p class="western" style="margin-bottom: 0in"># yum erase
tss2ibmtss-nnn-1.el6.x86_64</p>
<p class="western" style="margin-bottom: 0in"># yum erase
tss2ibmtss-debuginfo-nnn-1.el6.x86_64</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Install (new method)</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"># dnf install
./tss2ibmtss-nnn-1.el6.x86_64.rpm</p>
<p class="western" style="margin-bottom: 0in"># dnf install
./tss2ibmtss-devel-nnn-1.el6.x86_64.rpm</p>
<p class="western" style="margin-bottom: 0in"># dnf install
./tss2ibmtss-debuginfo-nnn-1.el6.x86_64.rpm</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Install (old method)</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"># yum install
./tss2ibmtss-nnn-1.el6.x86_64.rpm</p>
<p class="western" style="margin-bottom: 0in"># yum install
./tss2ibmtss-devel-nnn-1.el6.x86_64.rpm</p>
<p class="western" style="margin-bottom: 0in"># yum install
./tss2ibmtss-debuginfo-nnn-1.el6.x86_64.rpm</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="3">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367580"></a>
		Repository Install</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Once the packages have
been upstreamed, use this process.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"># dnf install tss</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="4">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367581"></a>
		Install Test</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">This assumes that the
SW TPM has been installed, see this link:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><font color="#0000ff"><span lang="en-US"><u><a class="western" href="https://sourceforge.net/projects/ibmtpm20tss/?source=navbar"><span lang="en-US">https://sourceforge.net/projects/ibmtpm20tss/?source=navbar</span></a></u></span></font></p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">It also assumes that
the regression test has been installed.  See Section 7.5.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">In reg.sh, change the
utility prefix variable to tss.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">PREFIX=tss</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Run the regression
test:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">&gt; cd
~/rpmbuild/BUILD/tss2ibmtss-nnn/utils</p>
<p class="western" style="margin-bottom: 0in">&gt; ./reg.sh</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="5">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367582"></a><a name="_Ref456884269"></a>
		Source rpms</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Install source (as
non-root user)</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">&gt; rpm -ivh
tss2ibmtss-nnn-1.el6.src.rpm</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The src rpm has a
tarball and spec file.  To build:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">&gt; cd ~/rpmbuild</p>
<p class="western" style="margin-bottom: 0in">&gt; rpmbuild -bp
SPECS/tss2ibmtss.spec</p>
<p class="western" style="margin-bottom: 0in">&gt; cd
BUILD/tss2ibmtss-nnn/utils</p>
<p class="western" style="margin-bottom: 0in">&gt; make -f
makefile.fedora</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol start="8">
	<li/>
<h1 class="western" align="justify" style="margin-top: 0.25in; margin-bottom: 0.17in; letter-spacing: 0.4pt; page-break-before: always"><a name="__RefHeading___Toc520367583"></a>
	<font size="2" style="font-size: 11pt">Status</font></h1>
	<ol>
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367584"></a>
		Utilities</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The utilities serve
several purposes:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">The utilities
	are called by a Unix shell or bat script to form the regression
	test.  
	</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">The utilities
	are sample code on how to use the TSS.</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">The utilities
	can be used in a script for rapid prototyping. 
	</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">The regression
	test scripts are sample code for how to use the utilities and the
	TPM to perform multi-step tasks.</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">NOTE:  The utility
command line arguments are not stable.  They change occasionally to
improve consistency among utilities or to add features</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The utilities currently
do not permit all TPM command options.  Let me know what needs
enhancement.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="2">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367585"></a>
		Bugs</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">Please report bugs.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ol>
	<ol start="3">
		<li/>
<h2 class="western"><a name="__RefHeading___Toc520367586"></a>
		Untested</h2>
	</ol>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">These may &quot;just
work&quot; but they have not been tested yet.  
</p>
<p class="western" style="margin-bottom: 0in">Users are welcome to
suggest ECC tests and prioritize the below list.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">ECC commands -
	ECDH_KeyGen, ECDH_ZGen 
	</p>
	<li/>
<p class="western" style="margin-bottom: 0in">PolicyLocality</p>
	<li/>
<p class="western" style="margin-bottom: 0in">TestParams 
	</p>
</ul>
<p style="margin-left: 0.5in; margin-bottom: 0.14in; line-height: 115%">
<br/>
<br/>

</p>
<ol start="9">
	<li/>
<h1 class="western" align="justify" style="margin-top: 0.25in; margin-bottom: 0.17in; letter-spacing: 0.4pt; page-break-before: always"><a name="__RefHeading___Toc520367587"></a>
	<font size="2" style="font-size: 11pt">Theading</font></h1>
</ol>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">The TSS is not thread
safe.</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">There are many issues
with making a TSS thread safe, because the TPM is inherently single
threaded.  For example:</p>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<ul>
	<li/>
<p class="western" style="margin-bottom: 0in">There is only
	one channel to a TPM.  Two threads writing bytes to a socket to a
	resource manager or simulator, or writing bytes to the device
	driver, will fail.</p>
	<li/>
<p class="western" style="margin-bottom: 0in">The TPM has
	session state that has to be coordinated with an application.  For
	example, if a thread begins to calculate an HMAC for a session, and
	another thread uses the session, the rolling nonces will cause the
	first thread HMAC to fail.</p>
	<li/>
<p class="western" style="margin-bottom: 0in">Applications
	have state at a higher level.  For example, if a thread begins to
	use a key and another thread saves the key context and flushes the
	key, the first thread's application will fail.</p>
</ul>
<p class="western" style="margin-bottom: 0in"><br/>

</p>
<p class="western" style="margin-bottom: 0in">I think the best we can
do is provide a common &quot;TSS lock semaphore&quot; mechanism, so
that threads can coordinate access to the TSS using a common API.</p>
<p class="western" style="margin-bottom: 0in; display: none"><a name="_PictureBullets"></a>
<br/>

</p>
<div title="footer">
	<p style="margin-top: 0.46in; margin-bottom: 0in"><font size="3" style="font-size: 11pt">	Page
	<sdfield type=PAGE subtype=RANDOM format=PAGE>34</sdfield>	</font></p>
</div>
</body>
</html>